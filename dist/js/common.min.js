$(".noscript").removeClass("noscript"),navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&jQuery(".side").bind("mousewheel",function(t){t.preventDefault();var a=this.scrollTop;this.scrollTop=a+t.deltaY*t.deltaFactor*-1}),$(".login__pass").focus(function(){$(".owl").addClass("pass")}),$(".login__pass").blur(function(){$(".owl").removeClass("pass")}),$(document).ready(function(){$(".popup-add").magnificPopup({type:"inline"})}),$(document).on("click",".tab__btn",function(){if($(this).hasClass("tab__btn_active"))return!1;$(this).parent().find(".tab__btn_active").removeClass("tab__btn_active"),$(this).parent().parent().find(".tab_active").removeClass("tab_active"),$(this).addClass("tab__btn_active");var t="."+$(this).attr("data-tab");$(t).addClass("tab_active"),$(".marks-wrap").is(":visible")&&($(".new_adding").hide(),$(".add_work").show())}),$(document).on("click",".add_work",function(){$(this).hide(),$(this).parent().find(".new_adding").css("display","inline-block")}),$(document).on("click",".first-group-btn",function(){if(!$.isNumeric($(".first-group").val()))return!1;$.ajax({data:"first-group="+$(".first-group").val(),type:"post",url:"functions.php",success:function(t){location.reload()}})}),$(document).on("submit",".new_work",function(t){var a=$(this),n=$(".marks__title").attr("data-stud");$.ajax({data:a.serialize()+"&stud_id="+n,type:"post",url:"functions.php",success:function(t){"error"==$.trim(t)?$(a).parent().parent().html("Не удалось добавить работу :("):$(a).parent().parent().html(t)}}),t.preventDefault()}),$(document).on("submit",".new_order",function(t){var a=$(this),n=$(".marks__title").attr("data-stud");$.ajax({data:a.serialize()+"&stud_id="+n,type:"post",url:"functions.php",success:function(t){"error"==$.trim(t)?$(a).parent().parent().html("Не удалось добавить приказ :("):$(a).parent().parent().html(t)}}),t.preventDefault()}),$(document).on("submit",".new_diploma",function(t){var a=$(this),n=$(".marks__title").attr("data-stud");$.ajax({data:a.serialize()+"&stud_id="+n,type:"post",url:"functions.php",success:function(t){"error"==$.trim(t)?$(a).parent().parent().html("Не удалось добавить работу :("):$(a).parent().parent().html(t)}}),t.preventDefault()}),$(document).on("submit",".login_form",function(t){var a=$(this);$.ajax({data:a.serialize(),type:"post",url:"functions.php",success:function(t){"error"==$.trim(t)?$(".login__error").html("Ой. Что-то не так :("):location.reload()}}),t.preventDefault()}),$(document).on("keypress",".g_name_first",function(t){13==t.which&&$.ajax({data:"create_group="+$(this).val(),type:"post",url:"functions.php",success:function(t){"error"==$.trim(t)?alert("Не удалось добавить группу!"):window.location.href="index.php"}})}),$(document).on("click",function(t){if("settings"==t.target.className)return!1;"settings-btn"===t.target.className?($(".settings-btn").hasClass("settings-btn_active")?$(".settings-btn").removeClass("settings-btn_active"):$(".settings-btn").addClass("settings-btn_active"),$(".settings").toggle()):$(".settings-btn").hasClass("settings-btn_active")&&($(".settings-btn").removeClass("settings-btn_active"),$(".settings").toggle())}),$(document).on("click",".exit",function(){if(!confirm("Вы уверены, что хотите выйти?"))return!1}),$(document).on("submit","#add_stud",function(t){var a=$(this);$.ajax({data:a.serialize(),type:"post",url:"functions.php",success:function(t){location.reload()}}),t.preventDefault()}),$(document).on("click",".table_left .del-stud",function(){if(confirm("Вы уверены, что хотите удалить студента?")){var t=$(this).parent();$.ajax({data:"del_stud="+t.attr("data-stud"),type:"post",url:"functions.php",success:function(t){location.reload()}})}}),$(document).on("click",".table_practice td:last-of-type",function(){if(confirm("Вы уверены, что хотите удалить модуль?")){var t=$(this);$.ajax({data:"del_practice="+t.attr("data-pr"),type:"post",url:"functions.php",success:function(t){location.reload()}})}}),$(document).on("submit","#add_practice",function(t){var a=$(this);$.ajax({data:a.serialize(),type:"post",url:"functions.php",success:function(t){location.reload()}}),t.preventDefault()}),$(document).on("click",".w_del",function(){if(confirm("Вы уверены, что хотите удалить курсовую?")){var t=$(this).attr("data-wid");$.ajax({data:"del_work="+t,type:"post",url:"functions.php",success:function(t){location.reload()}})}}),$(document).on("click",".o_del",function(){if(confirm("Вы уверены, что хотите удалить приказ?")){var t=$(this).attr("data-oid");$.ajax({data:"del_order="+t,type:"post",url:"functions.php",success:function(t){location.reload()}})}}),$(document).on("click",".table_right .del-sub",function(){if(confirm("Вы уверены, что хотите удалить предмет?")){var t=$(this).parent();$.ajax({data:"del_sub="+t.attr("data-sub"),type:"post",url:"functions.php",success:function(t){location.reload()}})}}),$(document).on("click",".d_del",function(){if(confirm("Вы уверены, что хотите удалить дипломную?")){var t=$(this);$.ajax({data:"del_dip="+t.attr("data-did"),type:"post",url:"functions.php",success:function(t){location.reload()}})}}),$(document).on("submit","#add_sub",function(t){var a=$(this);$.ajax({data:a.serialize(),type:"post",url:"functions.php",success:function(t){location.reload()}}),t.preventDefault()}),$(document).on("click",".edit-stud",function(){var t=$(this).parent().parent().find($(".student_name")),a=t.text();t.html("<input value='"+a+"'>"),$(this).remove()}),$(document).on("click",".table_left td:not(:last-of-type)",function(){var t=$(this).parent().find(".student_name").text();id=$(this).parent().find(".student_id").attr("data-stud"),sub_exist=0,grade=$(this).parent().find(".student_id").attr("data-grade"),$(".table_right").length&&(sub_exist=1),$.ajax({data:"stud_name="+t+"&show_stud="+id+"&sub_exist="+sub_exist+"&grade_11="+grade,type:"post",url:"functions.php",success:function(t){$(".marks-content").html(t),$(".marks-wrap").show(),$(".marks-form").find("tr:not(:first-of-type), tr:not(:nth-of-type(2))").each(function(){var t=0;num=0,$(this).find("td:not(:first-of-type), td:not(:last-of-type)").each(function(){$.isNumeric($(this).find("input").val())&&(num++,t+=Number($(this).find("input").val()))}),0!=num&&$(this).find("td").find("input[name='diploma']").attr("placeholder",(t/num).toFixed(2))})}})}),$(document).on("click",".marks-wrap",function(t){t.target===this&&($(".marks-wrap").hide(),$(".marks-content").html(""))}),$(document).on("click",".marks-close",function(t){$(".marks-wrap").hide(),$(".marks-content").html("")}),$(document).on("click",".table_right td:not(:last-of-type)",function(){var t=$(this).parent().find(".sub_name").text();id=$(this).parent().find(".sub_id").attr("data-sub"),stud_exist=0,$(".table_left").length&&(stud_exist=1),$.ajax({data:"sub_name="+t+"&show_sub="+id+"&stud_exist="+stud_exist,type:"post",url:"functions.php",success:function(t){$(".marks-content").html(t),$(".marks-wrap").show(),$(".marks-form").find("tr:not(:first-of-type), tr:not(:nth-of-type(2))").each(function(){var t=0;num=0,$(this).find("td:not(:first-of-type), td:not(:last-of-type)").each(function(){$.isNumeric($(this).find("input").val())&&(num++,t+=Number($(this).find("input").val()))}),0!=num&&$(this).find("td").find("input[name='diploma']").attr("placeholder",(t/num).toFixed(2))})}})}),$(document).on("click",".table_practice td:not(:last-of-type)",function(){var t=$(this).parent().find(".m_name").text();id=$(this).parent().find(".m_name").attr("data-mid"),$.ajax({data:"show_pr="+id+"&m_name="+t,type:"post",url:"functions.php",success:function(t){$(".marks-content").html(t),$(".marks-wrap").show()}})}),$("input[name='new_stud']").on("keyup",function(){$(this).val().length>32?($(this).css({"border-color":"#f77482"}),$(this).parent().find(".form__btn").attr("disabled",!0),$(this).parent().find(".form__btn").addClass("form__btn_disabled")):($(this).css({"border-color":"#d6d6d6"}),$(this).parent().find(".form__btn").removeAttr("disabled"),$(this).parent().find(".form__btn").removeClass("form__btn_disabled"))}),$("input[name='new_sub']").on("keyup",function(){$(this).val().length>60?($(this).css({"border-color":"#f77482"}),$(this).parent().find(".form__btn").attr("disabled",!0),$(this).parent().find(".form__btn").addClass("form__btn_disabled")):($(this).css({"border-color":"#d6d6d6"}),$(this).parent().find(".form__btn").removeAttr("disabled"),$(this).parent().find(".form__btn").removeClass("form__btn_disabled"))}),$(document).on("focus",".marks__mark, .m_marks__mark",function(){$(this).attr("maxlength",1)}),$(document).on("keydown keyup",".marks__mark",function(t){if(8==t.which){if($(this).removeClass("mark_2 mark_3 mark_4 mark_5"),0==$(this).val().length)return!1;$.ajax({data:"del_mark=1&sub="+$(this).parent().parent().find(".sub").attr("data-subid")+"&sem="+$(this).parent().index()+"&stud="+$(".marks__title").attr("data-stud"),type:"post",url:"functions.php"})}else if("keyup"==t.type)if(37==t.which||38==t.which||39==t.which||40==t.which){var a=$(this).parent().parent().parent(),n=$("input:focus",a),e=null,s="input:visible",i=parseInt(n.closest("td").index())+1;switch(t.which){case 37:e=n.parent("td").prev().find(s);break;case 38:e=n.closest("tr").prev().find("td:nth-child("+i+")").find(s);break;case 39:e=n.closest("td").next().find(s);break;case 40:e=n.closest("tr").next().find("td:nth-child("+i+")").find(s)}e&&e.length&&e.focus()}else{if(!$.isNumeric(t.key))return!1;if(parseInt(t.key)<2||parseInt(t.key)>5)return!1}switch($(this).attr("class","cleanstate"),$(this).addClass("marks__mark"),$(this).val()){case"5":$(this).addClass("mark_5");break;case"4":$(this).addClass("mark_4");break;case"3":$(this).addClass("mark_3");break;case"2":$(this).addClass("mark_2")}}),$(document).on("blur",".marks__mark",function(){if(""==$(this).val())return!1;var t=$(this).parent().index();if(sum=$(this).parent().parent().children("td").length,value=$(this).val(),tr=$(this).parent().parent(),void 0==(a=tr.find(".sub").attr("data-subid"))){n=tr.find(".stud").attr("data-stud");var a=$(".marks__title").attr("data-sub")}else var n=$(".marks__title").attr("data-stud");notEmpty=!1,tr.find("td").not(":first-of-type").each(function(){if(""!=$(this).find("input").val())return notEmpty=!0,!1}),notEmpty?$.ajax({data:"add_mark=1&subid="+a+"&sem="+t+"&value="+value+"&stud="+n+"&sum="+sum,type:"post",url:"functions.php"}):$.ajax({data:"first=1&subid="+a+"&sem="+t+"&value="+value+"&stud="+n+"&sum="+sum,type:"post",url:"functions.php"})}),$(document).on("blur",".m_marks__mark",function(){if(""==$(this).val())return!1;var t=$(this).parent().index();value=$(this).val(),tr=$(this).parent().parent(),mid=$(".marks__title").attr("data-mid"),stud=tr.find($(".stud")).attr("data-stud"),null==stud&&(stud=$(".marks__title").attr("data-stud"),mid=tr.find(".m_name").attr("data-mid")),notEmpty=!1,tr.find("td").not(":first-of-type").each(function(){if(""!=$(this).find("input").val())return notEmpty=!0,!1}),notEmpty?$.ajax({data:"add_mod_mark=1&mid="+mid+"&sem="+t+"&value="+value+"&stud="+stud,type:"post",url:"functions.php"}):$.ajax({data:"mod_first=1&mid="+mid+"&sem="+t+"&value="+value+"&stud="+stud,type:"post",url:"functions.php"})}),$(document).on("keydown keyup",".m_marks__mark",function(t){if(parseInt(t.key)>5||parseInt(t.key)<2)return!1;if(8==t.which){if($(this).removeClass("mark_2 mark_3 mark_4 mark_5"),0==$(this).val().length)return!1;var a=$(this).parent().parent().find(".m_name").attr("data-mid");stud=$(".marks__title").attr("data-stud"),null==a&&(a=$(".marks__title").attr("data-mid"),stud=$(this).parent().parent().find(".stud").attr("data-stud")),$.ajax({data:"del_mark=1&mid="+a+"&sem="+$(this).parent().index()+"&stud="+stud,type:"post",url:"functions.php"})}}),$(document).on("focus",".marks__mark",function(){$(this).attr("autocomplete","off")}),$(document).on("submit",".sets_edit_name",function(t){var a=$(this);$.ajax({data:a.serialize(),type:"post",url:"functions.php",success:function(t){"error"==$.trim(t)?alert("Что-то пошло не так."):location.reload()}}),t.preventDefault()}),$(document).on("submit",".sets_edit_pass",function(t){if($("input[name='set_repeat']").val()!=$("input[name='set_newpass']").val())return alert("Пароли не совпадают!"),!1;var a=$(this);$.ajax({data:a.serialize(),type:"post",url:"functions.php",success:function(t){"error"==$.trim(t)?alert("Что-то пошло не так."):location.reload()}}),t.preventDefault()}),$(document).on("keyup keydown","input[name='set_oldpass']",function(){""!=$("input[name='set_oldpass']").val()?($("input[name='set_newpass']").prop("required",!0),$("input[name='set_repeat']").prop("required",!0)):($("input[name='set_newpass']").prop("required",!1),$("input[name='set_repeat']").prop("required",!1))}),$(document).on("click",".table_left td:last-child",function(){if(confirm("Все данные студентов и куратора будут удалены. Вы уверены?")){var t=$(this);$.ajax({data:"del_curator="+t.attr("data-curator"),type:"post",url:"functions.php",success:function(t){location.reload()}})}}),$(document).on("keypress",".form__input",function(){$(this).removeClass("form__input_invalid")}),$(document).on("submit","#add_curator",function(t){var a=!1;if($.each($("#add_curator .form__input"),function(){if(""==$.trim($(this).val()))return a=!0,!1}),a)return alert("Заполните все поля!"),!1;if($("input[name='new_curator_login']").val().indexOf(" ")>=0)return alert("Логин содержит пробелы!"),$("input[name='new_curator_login']").addClass("form__input_invalid"),!1;if($.each($(".cur_login"),function(){if($("input[name='new_curator_login']").val()==$(this).text())return alert("Такой логин уже занят!"),$("input[name='new_curator_login']").addClass("form__input_invalid"),a=!0,!1}),a)return!1;if(3!=$("input[name='new_curator']").val().split(" ").length)return alert("Введите полное ФИО!"),$("input[name='new_curator']").addClass("form__input_invalid"),!1;var n=$(this).serialize();$.ajax({data:n,type:"post",url:"functions.php",success:function(t){location.reload()}}),t.preventDefault()}),$(document).on("click",".table_curators tr td:not(:last-child)",function(){$(".side-info-text").remove(),$(".curator_info").show(),$(".table_tr_active").removeClass("table_tr_active"),$(this).parent().addClass("table_tr_active")}),$(document).on("submit","#new_cur_login",function(t){if(""==$.trim($("#new_login").val()))return $("#new_login").val(""),!1;var a=$(".table_tr_active").find(".del-curator").parent().attr("data-curator"),n=$(this);$.ajax({data:n.serialize()+"&new_cur_login="+a,type:"post",url:"functions.php",success:function(t){"error"==$.trim(t)?alert("Такой логин уже занят!"):location.reload()}}),t.preventDefault()}),$(document).on("submit","#new_cur_pass",function(t){if(""==$.trim($("#new_pass").val()))return $("#new_pass").val(""),!1;var a=$(".table_tr_active").find(".del-curator").parent().attr("data-curator"),n=$(this);$.ajax({data:n.serialize()+"&new_cur_pass="+a+"&set_oldpass=1",type:"post",url:"functions.php",success:function(t){location.reload()}}),t.preventDefault()}),$(document).on("click",".sem-report",function(t){t.stopPropagation(),$(".choose-sem").toggle()}),$(document).on("click",".choose-sem span",function(){$.ajax({data:"sem="+$(this).text(),type:"post",url:"sem_report.php",success:function(t){}})});